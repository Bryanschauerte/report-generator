"use strict";angular.module("reportGenerator",["ui.router","stripe.checkout"]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("home",{url:"/",template:"<landing-Page></landing-Page>"}).state("myClasses",{url:"/myClasses",template:"<my-Classes></my-Classes>",resolve:{user:["authService",function(t){return t.getAuth()}]}}).state("myAccount",{url:"/myAccount",template:"<my-Account></my-Account>"})}]),angular.module("reportGenerator").controller("mainCtrl",function(){}),angular.module("reportGenerator").factory("authService",["$http","$location",function(t,e){return{getAuth:function(){return t.get("/auth").success(function(t){return t}).error(function(t){console.error(t),e.path("/#/myAccount")})}}}]),angular.module("reportGenerator").service("classService",["$http",function(t){this.getUser=function(){return t({method:"GET",url:"/auth"})},this.getUserClasses=function(e){return t({method:"GET",url:"/api/user/"+e})},this.newClassToAdd=function(e,r){return t({method:"PUT",url:"/api/user/add-group/"+e,data:{className:r}})},this.removeClass=function(e,r){return t({method:"DELETE",url:"/api/"+e+"/groups/"+r})},this.newStudentToAdd=function(e,r,n){return t({method:"PUT",url:"/api/"+e+"/groups/"+n+"/newStudent",data:{newStudent:r}})},this.getClassInfo=function(e){return t({method:"GET",url:"/api/"+e+"/get"})},this.deleteStudent=function(e,r,n){return t({method:"DELETE",url:"/api/"+e+"/groups/remove-student/"+r+"/"+n})},this.changeAttribute=function(e,r){return t({method:"PUT",url:"/api/"+e+"/groups/update-grade/",data:r})},this.compileReports=function(e,r){return t({method:"PUT",url:"/api/"+e._id+"/group/makeClassReports",data:r})}}]),angular.module("reportGenerator").controller("classesHeadCtrl",["classService","$element","$scope",function(t,e,r){function n(){if(s.classes){for(var t=0;t<s.classes.lenght;t++)s.classStore.push(s.classes[t]);s.classes=s.classStore}}var s=this;this.classStore=[],this.removingClass=!1,this.getUser=function(){t.getUser().then(function(t,e){s.user=t.data,s.user&&s.getUserClasses()})},this.getUser(),this.getUserClasses=function(){var e=s.user._id;t.getUserClasses(e).then(function(t,e){for(var r=0;r<t.data.studentGroups.length;r++)s.classStore.push(t.data.studentGroups[r])})},this.startRemoveClass=function(){s.removingClass=!0,s.showReports=!1,s.showStudent=!1},this.removeClass=function(e){var r=s.user._id;t.removeClass(r,e._id).then(function(t,e){});for(var n=0;n<s.classStore.length;n++)s.classStore[n]._id==e._id&&s.classStore.splice(n,1);s.classes=s.classStore,s.classInfo=!1},this.endRemovingClass=function(){s.removingClass=!1},this.addingAClass=!1,r.$watch("is.classes",function(t,e){n()}),r.$watch("is.showStudent",function(t,e){}),this.startAdding=function(){s.showReports=!1,s.showStudent=!1,s.newClassName="",s.addingAClass=!s.addingAClass},this.doneAdding=function(e){for(var r=!0,n=0;n<s.classStore.length;n++)s.classStore[n].className==e&&(r=!1);if(r){var o={className:e,students:[]};e="";var a=s.user._id;t.newClassToAdd(a,o).then(function(t,e){s.classInfo=t.data,s.classStore.push(t.data)}),s.addingAClass=!s.addingAClass}else r||alert("Only new class names allowed");s.selectClass(s.classInfo)},this.selectClass=function(t){s.classInfo=t,s.showStudent=!1,s.showReports=!1},this.cancelAddingClass=function(){s.addingAClass=!s.addingAClass}}]),angular.module("reportGenerator").directive("classHead",function(){return{templateUrl:"./features/classesHead/classesHead.html",attribute:"E",controller:"classesHeadCtrl",controllerAs:"is",bindToController:!0,scope:{classes:"=",showStudent:"=",showReports:"=",user:"="}}}),angular.module("reportGenerator").controller("studentListCtrl",["$scope","$element","classService",function(t,e,r){var n=this;this.addingStudent=!1,this.showCompileStuff=!1,this.canDoReports=!0,this.doReports=function(t){n.showStudent=!1;var e=(n.user._id,n.user),s={studentList:t,user:e};n.user.dateOfSubscriptionEnd&&r.compileReports(e,s).then(function(t,e){"notAllowed"==t.data?(n.canDoReports=!1,n.showReports=!1):(n.canDoReports=!0,n.reports=t.data,n.showReports=!0)})},this.editStudent=function(t){n.showStudent=!0,t.classId=n.studentList._id,t.className=n.studentList.className,n.currentStudent=t,n.showReports=!1,this.showCompileStuff=!0},this.deleteStudent=function(t,e){var s=n.user._id;r.deleteStudent(s,t,e).then(function(t,e){});for(var o=0;o<n.studentList.students.length;o++)n.studentList.students[o]._id==e&&n.studentList.students.splice(o,1);n.classInfo=n.studentList,0==n.studentList.students.length&&(n.showCompileStuff=!1),n.showReports=!1,n.showStudent=!1},t.$watch("is.user",function(t,e){if(n.user.dateOfSubscriptionEnd||(n.canDoReports=!1),n.user.dateOfSubscriptionEnd){var r=function(){var t=function(){return new Date}();return t}(),s=r,o=new Date(n.user.dateOfSubscriptionEnd);s=s.getTime(),o=o.getTime(),s>o&&(n.canDoReports=!1)}}),t.$watch("is.classInfo",function(t,e){n.studentList=t,this.showCompileStuff=!1}),t.$watch("is.studentList.students",function(t,e){}),this.doIt=function(){$("select").material_select()},this.startAddNewStudent=function(){n.addingStudent=!n.addingStudent,n.showStudent=!1,n.showReports=!1},this.cancelAdd=function(){n.newStudent={},n.addingStudent=!n.addingStudent},this.endAddNewStudent=function(t){var e=n.studentList.className,s=n.studentList._id,o=t;n.newStudent={},o.classId=s,o.className=e;var a=n.user._id;r.newStudentToAdd(a,o,s).then(function(t,e){o=t.data.students[t.data.students.length-1],n.studentList.students.push(o),n.classInfo=n.studentList}),this.addingStudent=!1}}]),angular.module("reportGenerator").directive("studentList",function(){return{templateUrl:"./features/listOfStudents/studentList.html",attribute:"E",controller:"studentListCtrl",controllerAs:"is",bindToController:!0,scope:{studentInfo:"=",classInfo:"=",showStudent:"=",showReports:"=",reports:"=",user:"="}}}),angular.module("reportGenerator").controller("navBarCtrl",function(){}),angular.module("reportGenerator").directive("navbar",function(){return{templateUrl:"./features/navBar/navBarTemplate.html",attribute:"E",controller:"navBarCtrl",controllerAs:"is",bindToController:!0,scope:{user:"="}}}),angular.module("reportGenerator").controller("oneMonthCtrl",["$scope","$http","classService",function(t,e,r){var n=this;this.getUser=function(){r.getUser().then(function(t,e){n.user=t.data})}(),this.doCheckout=function(t){var r=n.user._id;return e({method:"POST",url:"/api/"+r+"/monthCharge",data:{stripeToken:t}}).then(function(t,e){e&&console.log(e,"eeor"),t&&(n.user=t.data)})}}]),angular.module("reportGenerator").directive("oneMonth",function(){return{templateUrl:"./features/oneMonthcheckoutForm/oneMonth.html",attribute:"E",controller:"oneMonthCtrl",controllerAs:"is",bindToController:!0,scope:{user:"="}}}),angular.module("reportGenerator").controller("reportCtrl",["$scope","$element","classService",function(t,e,r){var n=this;t.$watch("is.reports",function(t,e){n.reportsToShow=t,n.reportsToShow,this.showCompileStuff=!1})}]),angular.module("reportGenerator").directive("report",function(){return{templateUrl:"./features/report/report.html",attribute:"E",controller:"reportCtrl",controllerAs:"is",bindToController:!0,scope:{classInfo:"=",showStudent:"=",showReports:"=",reports:"=",user:"="}}}),angular.module("reportGenerator").controller("signInBoxCtrl",["$scope","authService","classService",function(t,e,r){var n=this;n.getDateOfToday=function(){var t=function(){return new Date}();return t}(),this.getUser=function(){r.getUser().then(function(t,e){n.user=t.data})},this.getUser(),t.$watch("is.user",function(t,e){}),t.$watch("is.user.dateOfSubscriptionEnd",function(t,e){})}]),angular.module("reportGenerator").directive("signIn",function(){return{templateUrl:"./features/signInBox/signInBox.html",attribute:"E",controller:"signInBoxCtrl",controllerAs:"is",bindToController:!0,scope:{user:"="}}}),angular.module("reportGenerator").controller("studentCtrl",["$scope","classService","$element",function(t,e,r){var n=this;this.student=n.studentInfo,this.changeStudentAtt=function(t){var r=n.classInfo._id;t.classId=r;var s=n.user._id;e.changeAttribute(s,t)},this.doneDoing=function(t){n.student.markAs={"background-color":"#00FF67"},n.studentInfo=t},this.notDoneDoing=function(t){t.markAs={"background-color":"#FF3100"},n.studentInfo=t},t.$watch("is.studentInfo",function(t,e){n.student=n.studentInfo}),this.doIt=function(){$("select").material_select()}}]),angular.module("reportGenerator").directive("student",function(){return{templateUrl:"./features/studentAts/student.html",attribute:"E",controller:"studentCtrl",controllerAs:"is",bindToController:!0,scope:{studentInfo:"=",showStudent:"=",showReports:"=",classInfo:"=",user:"="}}}),angular.module("reportGenerator").directive("yearPay",function(){return{templateUrl:"./features/yearCheckout/yearPay.html",attribute:"E",controller:"yearPayCtrl",controllerAs:"is",bindToController:!0,scope:{user:"="}}}),angular.module("reportGenerator").controller("yearPayCtrl",["$scope","classService","$http",function(t,e,r){var n=this;this.getUser=function(){e.getUser().then(function(t,e){n.user=t.data})}(),this.doCheckout=function(t){var e=n.user._id;return r({method:"POST",url:"/api/"+e+"/yearCharge",data:{stripeToken:t}}).then(function(t,e){e&&console.log(e,"eeor"),t&&(n.user=t.data)})}}]),angular.module("reportGenerator").controller("landingPageCtrl",function(){$(document).ready(function(){$(".parallax").parallax()}),!function(t){var e={animation:"dissolve",separator:",",speed:2e3};t.fx.step.textShadowBlur=function(e){t(e.elem).prop("textShadowBlur",e.now).css({textShadow:"0 0 "+Math.floor(e.now)+"px black"})},t.fn.textrotator=function(r){var n=t.extend({},e,r);return this.each(function(){var e=t(this),r=[];t.each(e.text().split(n.separator),function(t,e){r.push(e)}),e.text(r[0]);var s=function(){switch(n.animation){case"dissolve":e.animate({textShadowBlur:20,opacity:0},500,function(){o=t.inArray(e.text(),r),o+1==r.length&&(o=-1),e.text(r[o+1]).animate({textShadowBlur:0,opacity:1},500)});break;case"flip":e.find(".back").length>0&&e.html(e.find(".back").html());var s=e.text(),o=t.inArray(s,r);o+1==r.length&&(o=-1),e.html(""),t("<span class='front'>"+s+"</span>").appendTo(e),t("<span class='back'>"+r[o+1]+"</span>").appendTo(e),e.wrapInner("<span class='rotating' />").find(".rotating").hide().addClass("flip").show().css({"-webkit-transform":" rotateY(-180deg)","-moz-transform":" rotateY(-180deg)","-o-transform":" rotateY(-180deg)",transform:" rotateY(-180deg)"});break;case"flipUp":e.find(".back").length>0&&e.html(e.find(".back").html());var s=e.text(),o=t.inArray(s,r);o+1==r.length&&(o=-1),e.html(""),t("<span class='front'>"+s+"</span>").appendTo(e),t("<span class='back'>"+r[o+1]+"</span>").appendTo(e),e.wrapInner("<span class='rotating' />").find(".rotating").hide().addClass("flip up").show().css({"-webkit-transform":" rotateX(-180deg)","-moz-transform":" rotateX(-180deg)","-o-transform":" rotateX(-180deg)",transform:" rotateX(-180deg)"});break;case"flipCube":e.find(".back").length>0&&e.html(e.find(".back").html());var s=e.text(),o=t.inArray(s,r);o+1==r.length&&(o=-1),e.html(""),t("<span class='front'>"+s+"</span>").appendTo(e),t("<span class='back'>"+r[o+1]+"</span>").appendTo(e),e.wrapInner("<span class='rotating' />").find(".rotating").hide().addClass("flip cube").show().css({"-webkit-transform":" rotateY(180deg)","-moz-transform":" rotateY(180deg)","-o-transform":" rotateY(180deg)",transform:" rotateY(180deg)"});break;case"flipCubeUp":e.find(".back").length>0&&e.html(e.find(".back").html());var s=e.text(),o=t.inArray(s,r);o+1==r.length&&(o=-1),e.html(""),t("<span class='front'>"+s+"</span>").appendTo(e),t("<span class='back'>"+r[o+1]+"</span>").appendTo(e),e.wrapInner("<span class='rotating' />").find(".rotating").hide().addClass("flip cube up").show().css({"-webkit-transform":" rotateX(180deg)","-moz-transform":" rotateX(180deg)","-o-transform":" rotateX(180deg)",transform:" rotateX(180deg)"});break;case"spin":e.find(".rotating").length>0&&e.html(e.find(".rotating").html()),o=t.inArray(e.text(),r),o+1==r.length&&(o=-1),e.wrapInner("<span class='rotating spin' />").find(".rotating").hide().text(r[o+1]).show().css({"-webkit-transform":" rotate(0) scale(1)","-moz-transform":"rotate(0) scale(1)","-o-transform":"rotate(0) scale(1)",transform:"rotate(0) scale(1)"});break;case"fade":e.fadeOut(n.speed,function(){o=t.inArray(e.text(),r),o+1==r.length&&(o=-1),e.text(r[o+1]).fadeIn(n.speed)})}};setInterval(s,n.speed)})}}(window.jQuery),$(".rotate").textrotator({animation:"dissolve",separator:",",speed:3e3})}),angular.module("reportGenerator").directive("landingPage",function(){return{templateUrl:"./views/landingPage/landingPageTemplate.html",attribute:"E",controller:"landingPageCtrl",controllerAs:"is",bindToController:!0,scope:{}}}),angular.module("reportGenerator").controller("myAccountCtrl",["classService",function(t){}]),angular.module("reportGenerator").directive("myAccount",function(){return{templateUrl:"./views/myAccount/myAccountTemplate.html",attribute:"E",controller:"myAccountCtrl",controllerAs:"is",bindToController:!0,scope:{user:"="}}}),angular.module("reportGenerator").controller("myClassesCtrl",function(){}),angular.module("reportGenerator").directive("myClasses",function(){return{templateUrl:"./views/myClasses/myClassesTemplate.html",attribute:"E",controller:"myClassesCtrl",controllerAs:"is",bindToController:!0,scope:{}}});